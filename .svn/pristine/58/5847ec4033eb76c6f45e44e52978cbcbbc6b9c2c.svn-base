<?php
session_start(); 
date_default_timezone_set("Asia/Taipei");
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);

include_once("lib/config.php");
include_once("lib/WebDB.php");
include_once("lib/basePage.php");

$viewData  = array();
class func_game extends basePage
{

    public function page_load()
    {

         if(!isset($_SESSION['fuser_account']))
        {
             $this->redirect('index.php','請先登入');
             return;
        }
        //是否登入
        //$this->isLogin();

        //get 上有要特別處理的參數
        $arrGetParam = array();
        //$arrGetParam['m'] = 'getMemberList';

        foreach($arrGetParam as $k=>$v)
        {
            if( isset( $_GET[$k]))
            {
                if($_GET[$k] == 'logout')
                {
                    $this->logout();
                }
            }
        }


        global $viewData ;
        $viewData['member'] = $this->getMember();
        setcookie('member_point',$viewData['member']['point']);
        setcookie('member_account',$viewData['member']['account']);
        setcookie('member_name',$viewData['member']['name']);

        // var_dump($viewData);

    }

    public function getMember()
    {
        
            $account = $_SESSION['fuser_account'];
            $member = $this->_db->single_check('select * from member where account= @account ',array('account'=>$account));

            //var_dump($account);
            return $member;
       
    }
    public function logout()
    {
        if(isset($_SESSION["fuser_account"]))
        {
            unset($_SESSION["fuser_account"]);
        }
        echo '<script>alert("已登出");window.location="index.php";</script>';

    }


   
}

 $aa = new func_game();
 $aa->page_load();




?>